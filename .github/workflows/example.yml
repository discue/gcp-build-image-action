name: Example Usage

on:
  workflow_dispatch:
    inputs:
      project:
        description: 'GCP Project ID'
        required: true
      image:
        description: 'Full image URL'
        required: true
        default: 'europe-west3-docker.pkg.dev/my-project/my-repo/example-app'

env:
  PROJECT_ID: ${{ github.event.inputs.project }}
  IMAGE_URL: ${{ github.event.inputs.image }}

jobs:
  build-example:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v6

      # Note: In a real workflow, you would configure GCP authentication here
      # - name: Authenticate to Google Cloud
      #   uses: google-github-actions/auth@v1
      #   with:
      #     credentials_json: ${{ secrets.GCP_SA_KEY }}
      
      # - name: Set up Cloud SDK
      #   uses: google-github-actions/setup-gcloud@v1

      - name: Build example app image (dry run)
        id: build
        # For demonstration purposes, we'll just echo the command that would be run
        run: |
          echo "Would run: gcloud builds submit --pack image=${{ env.IMAGE_URL }} ./example --quiet"
          echo "image-url=${{ env.IMAGE_URL }}" >> $GITHUB_OUTPUT
        
      # Uncomment this section to actually use the action:
      # - name: Build example app image
      #   id: build
      #   uses: ./
      #   with:
      #     image: ${{ env.IMAGE_URL }}
      #     project: ${{ env.PROJECT_ID }}
      #     source: './example'
      
      - name: Show built image
        run: |
          echo "Built image: ${{ steps.build.outputs.image-url }}"